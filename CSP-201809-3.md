# 元素选择器      [返回首页](./index.md)   [上篇 CSP-M4](./CSP-M4.md)
## Problem
| | | 
|--|--| 
| 试题编号 | 201809-3 | 
| 试题名称 | 元素选择器| 
| 时间限制 | 1.0s     | 
| 内存限制 | 256.0MB  | 

![](https://blog.xupengbo.online/images/q1.jpg?raw=true)
![](https://blog.xupengbo.online/images/q2.jpg?raw=true)
![](https://blog.xupengbo.online/images/q3.jpg?raw=true)
![](https://blog.xupengbo.online/images/q4.jpg?raw=true)
![](https://blog.xupengbo.online/images/q5.jpg?raw=true)
## Idea

## Codes

```cpp
#include <bits/stdc++.h>
using namespace std;
int n,m;string a,b;
vector<string> pos; vector<int> ans;
struct doc{
	string label,id;
	int level,par;
	bool operator==(string t){
		return (t==id)||(t==label);
	}
}Tables[105];
void AddCSS(string str,int k){
	int i=0,j=k;
	while(str[i]=='.'){ i++; }
	Tables[k].level=i/2; if(k==1) Tables[k].par=0;
	else 
		while(j>=0){
			if(Tables[j].level==Tables[k].level-1){
		 		Tables[k].par=j;	break;
			}
			j--;
		}
	stringstream ss(str); ss>>a; ss>>b;
	transform(a.begin(),a.end(),a.begin(),::tolower); a=a.substr(i,a.size());
	Tables[k].label=a; Tables[k].id=b; ss.clear();
}  
bool check(int p, int q){//p表示元素组下标,q表示查询组下标  
	while(p>0 && q>=0){ 
		if(Tables[p]==pos[q]){
		 q--;
		}
		p=Tables[p].par;
	}
	return q==-1;
}
void Find(string str){
	pos.clear();
	stringstream ss(str);
	while(ss>>a){
		if(a[0]!='#') transform(a.begin(),a.end(),a.begin(),::tolower);//a不是id就小写 
		pos.push_back(a);
	}
	int siz=pos.size(); a=pos[siz-1]; ans.clear(); 
	else
	  for(int i=1;i<=n;++i){
		 if(Tables[i]==a){
			if(check(i,siz-1)) ans.push_back(i);
		 }
	 }
	cout<<ans.size(); for(int i=0;i<ans.size();++i) cout<<" "<<ans[i];	cout<<endl;
}
int main(){
	cin>>n>>m; string str;
	cin.ignore();
	for(int i=1;i<=n;++i){
		getline(cin,str);AddCSS(str,i);
	} 
	for(int i=0;i<m;++i){
		getline(cin,str); Find(str);
	}
	return 0;
}
```


# 结束!     [返回首页](./index.md)   [下篇 Week14](./week14.md)
